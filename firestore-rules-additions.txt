// ADD THESE RULES TO YOUR EXISTING firestore.rules FILE
// Just copy and paste these sections into your existing rules

// ===== NETFLIX-STYLE MEDIA COLLECTIONS (ADD THESE) =====

// Main Media Collection (for Netflix-style videos)
match /media/{mediaId} {
  // Allow read access to all authenticated users
  allow read: if request.auth != null;
  
  // Allow write access only to HQ Admins
  allow create, update, delete: if request.auth != null 
    && request.auth.token.email in [
      'ihenacho23@gmail.com', 
      'ephraimloveworld1@gmail.com',
      'takeshopstores@gmail.com',
      'nnennawealth@gmail.com'
    ];
}

// Media Analytics Collection (for views, likes, etc.)
match /media_analytics/{analyticsId} {
  allow read, write: if request.auth != null;
}

// Media Comments Collection
match /media_comments/{commentId} {
  allow read: if request.auth != null;
  allow create: if request.auth != null 
    && request.auth.uid == request.resource.data.userId;
  allow update, delete: if request.auth != null 
    && (request.auth.uid == resource.data.userId 
        || request.auth.token.email in [
          'ihenacho23@gmail.com', 
          'ephraimloveworld1@gmail.com',
          'takeshopstores@gmail.com',
          'nnennawealth@gmail.com'
        ]);
}

// User Watch History (Netflix-style)
match /user_watch_history/{userId} {
  allow read, write: if request.auth != null 
    && request.auth.uid == userId;
}

// User Favorites (Netflix-style)
match /user_favorites/{userId} {
  allow read, write: if request.auth != null 
    && request.auth.uid == userId;
}

// ===== THAT'S IT! =====
// Your existing rules should handle everything else fine.
// The profiles permission error should be resolved with your current setup.